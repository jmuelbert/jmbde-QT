# Copyright (c) 2019 Jürgen Mülbert. All rights reserved.
#
# This file is part of jmbde
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# .
# This package is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# .
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <https://www.gnu.org/licenses/>.
# .
# On Debian systems, the complete text of the GNU General
ä Public License version 3 can be found in "/usr/share/common-licenses/GPL-3".

Name:           @NAME@
Version:        @VERSION@
Release:        @RELEASE@
Summary:        A little BDE program

Group:          Applications/Business
License:        GPL-3.0+
Url:            http://jmuelbert.github.io/jmbde-QT/
Source:         @SOURCE@
BuildRequires:  cmake
BuildRequires:  gcc-c++
BuildRequires:  qt5-qtbase-devel >= 5.12.8
BuildRequires:  qt5-qttools-devel >= 5.12.8

%description
A little BDE program

%prep
%setup -q -n @NAME_VERSION@

%build
%cmake -DCMAKE_BUILD_TYPE:STRING=Release -DEMBED_TRANSLATIONS:BOOL=ON .
%make_build

%install
rm -rf "$RPM_BUILD_ROOT"
%make_install
install -D LICENSE "$RPM_BUILD_ROOT"/%{_datadir}/licenses/jmbde/LICENSE
install -D README.md "$RPM_BUILD_ROOT"/%{_docdir}/jmbde/README.md

%check
desktop-file-validate %{buildroot}%{_datadir}/applications/*.desktop

# Exclude openSUSE. The appstream-glib package is broken there.
%if !0%{?suse_version}
appstream-util validate-relax --nonet %{buildroot}%{_datadir}/appdata/*.appdata.xml
%endif

%post
%desktop_database_post
%icon_theme_cache_post

%postun
%desktop_database_postun
%icon_theme_cache_postun

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%license LICENSE
%doc README.md
%{_bindir}/%{name}
%{_datadir}/%{name}/
%{_datadir}/applications/*
%{_datadir}/icons/*
%{_datadir}/metainfo/*


%changelog
